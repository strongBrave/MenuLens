# MenuGen - é¡¹ç›®è§„èŒƒæ–‡æ¡£ (React + Gemini ç‰ˆ)

**æ›´æ–°æ—¥æœŸ**: 2026-01-20  
**é¡¹ç›®ç‰ˆæœ¬**: 1.0 MVP

---

## 1. é¡¹ç›®æ¦‚è§ˆ

### æ ¸å¿ƒç›®æ ‡
æ„å»ºä¸€ä¸ªå…¨æ ˆ Web åº”ç”¨ï¼Œè®©ç”¨æˆ·èƒ½å¤Ÿï¼š
1. ä¸Šä¼ èœå•å›¾ç‰‡
2. AI è‡ªåŠ¨è¯†åˆ«èœå“ä¿¡æ¯ï¼ˆåç§°ã€æè¿°ã€å£å‘³æ ‡ç­¾ï¼‰
3. ä¸ºæ¯é“èœè‡ªåŠ¨æœç´¢ç½‘ç»œå›¾ç‰‡
4. ä»¥ç¾è§‚çš„å¡ç‰‡å½¢å¼å±•ç¤ºå®Œæ•´èœå•æ•°æ®

### æ ¸å¿ƒçº¦æŸ
- ğŸ¤– **æ¨¡å‹æº**: Gemini (gemini-1.5-pro æˆ– gemini-2.0-flash-exp)
- ğŸ”§ **è°ƒç”¨æ–¹å¼**: OpenAI Python SDKï¼ˆé€šè¿‡ base_url é‡å®šå‘ï¼‰
- ğŸ” **æœç´¢**: Google Custom Search JSON APIï¼ˆé€šç”¨æœç´¢è¯ï¼Œç¦æ­¢é¤å…åç§°ï¼‰
- ğŸ—ï¸ **æ¶æ„**: å‰åç«¯åˆ†ç¦»ï¼ˆReact + FastAPIï¼‰

---

## 2. æŠ€æœ¯æ ˆ

| ç»„ä»¶ | æŠ€æœ¯ | ç‰ˆæœ¬ |
|------|------|------|
| **Frontend** | React | 18+ |
| **æ„å»ºå·¥å…·** | Vite | 5+ |
| **æ ·å¼** | Tailwind CSS | 3+ |
| **HTTPå®¢æˆ·ç«¯** | Axios | 1.6+ |
| **åç«¯æ¡†æ¶** | FastAPI | 0.100+ |
| **Pythonç‰ˆæœ¬** | Python | 3.9+ |
| **LLMåº“** | openai | 1.0+ |
| **å¼‚æ­¥HTTP** | aiohttp | 3.9+ |
| **æ•°æ®éªŒè¯** | Pydantic | 2.0+ |
| **ç¯å¢ƒå˜é‡** | python-dotenv | 1.0+ |

---

## 3. ç³»ç»Ÿæ¶æ„

### 3.1 æ•°æ®æµ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                       â”‚
â”‚  React å‰ç«¯                                          â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ 1. ä¸Šä¼ èœå•å›¾ç‰‡ï¼ˆDrag & Dropï¼‰               â”‚   â”‚
â”‚  â”‚ 2. æ˜¾ç¤ºè¿›åº¦: "è¯†åˆ«ä¸­..." â†’ "æœç´¢å›¾ç‰‡ä¸­..."   â”‚   â”‚
â”‚  â”‚ 3. ç½‘æ ¼å±•ç¤ºèœå“å¡ç‰‡ï¼ˆMenuCardï¼‰              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                         â†•ï¸ (Axios)                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                       â”‚
â”‚  FastAPI åç«¯                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ POST /api/analyze-menu                       â”‚   â”‚
â”‚  â”‚                                              â”‚   â”‚
â”‚  â”‚ [1] æ¥æ”¶å›¾ç‰‡ â†’ Base64 ç¼–ç                    â”‚   â”‚
â”‚  â”‚ [2] è°ƒç”¨ Gemini API (OpenAI SDK)             â”‚   â”‚
â”‚  â”‚     â”œâ”€ è§£æèœå“ä¿¡æ¯                         â”‚   â”‚
â”‚  â”‚     â”œâ”€ æå–ï¼šåŸåã€è‹±æ–‡åã€æè¿°ã€å£å‘³æ ‡ç­¾   â”‚   â”‚
â”‚  â”‚     â””â”€ ç”Ÿæˆæœç´¢è¯                           â”‚   â”‚
â”‚  â”‚ [3] å¹¶å‘æœç´¢å›¾ç‰‡ (asyncio + aiohttp)        â”‚   â”‚
â”‚  â”‚     â”œâ”€ æŸ¥è¯¢: "{è‹±æ–‡å} {åŸå} food dish"    â”‚   â”‚
â”‚  â”‚     â”œâ”€ è°ƒç”¨ Google Custom Search API        â”‚   â”‚
â”‚  â”‚     â””â”€ æå–ç¬¬ä¸€ä¸ªç»“æœçš„å›¾ç‰‡ URL             â”‚   â”‚
â”‚  â”‚ [4] è¿”å›å®Œæ•´ JSON (å«å›¾ç‰‡ URL)              â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                       â”‚
â”‚  å¤–éƒ¨ API                                            â”‚
â”‚  â”œâ”€ Google Gemini (Vision AI)                        â”‚
â”‚  â””â”€ Google Custom Search (Image Search)              â”‚
â”‚                                                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3.2 åç«¯æ¨¡å—ç»“æ„

```
backend/
â”œâ”€â”€ main.py                  # FastAPI åº”ç”¨å…¥å£
â”œâ”€â”€ config.py               # ç¯å¢ƒå˜é‡é…ç½®
â”œâ”€â”€ schemas.py              # Pydantic æ•°æ®æ¨¡å‹
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ llm_service.py      # Gemini è§†è§‰è¯†åˆ«
â”‚   â””â”€â”€ search_service.py   # Google å›¾ç‰‡æœç´¢
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ file_utils.py       # æ–‡ä»¶å¤„ç†ï¼ˆBase64ç¼–ç ç­‰ï¼‰
â”œâ”€â”€ .env                    # ç¯å¢ƒå˜é‡ï¼ˆæœ¬åœ°ï¼‰
â”œâ”€â”€ .env.example            # ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â””â”€â”€ README.md              # åç«¯è¯´æ˜
```

### 3.3 å‰ç«¯æ¨¡å—ç»“æ„

```
frontend/
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ App.jsx            # ä¸»åº”ç”¨ç»„ä»¶
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ MenuUpload.jsx  # ä¸Šä¼ åŒºåŸŸ + æ‹–æ‹½
â”‚   â”‚   â”œâ”€â”€ MenuCard.jsx    # èœå“å¡ç‰‡ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ LoadingState.jsx# åŠ è½½è¿›åº¦æç¤º
â”‚   â”‚   â””â”€â”€ ErrorBoundary.jsx# é”™è¯¯å¤„ç†
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ client.js       # Axios é…ç½®
â”‚   â”œâ”€â”€ styles/
â”‚   â”‚   â””â”€â”€ index.css       # Tailwind + è‡ªå®šä¹‰
â”‚   â”œâ”€â”€ main.jsx            # å…¥å£
â”‚   â””â”€â”€ index.html
â”œâ”€â”€ tailwind.config.js      # Tailwind é…ç½®
â”œâ”€â”€ vite.config.js          # Vite é…ç½®
â”œâ”€â”€ package.json            # NPM ä¾èµ–
â””â”€â”€ README.md              # å‰ç«¯è¯´æ˜
```

---

## 4. API ç«¯ç‚¹è§„èŒƒ

### 4.1 POST /api/analyze-menu

**è¯·æ±‚**:
```json
{
  "image_file": "<binary image data>",
  "restaurant_name": "optional_context"
}
```

**å“åº”ï¼ˆæˆåŠŸï¼‰**:
```json
{
  "success": true,
  "dishes": [
    {
      "id": "dish_001",
      "original_name": "å®«ä¿é¸¡ä¸",
      "english_name": "Kung Pao Chicken",
      "description": "Tender chicken pieces with peanuts and dried chilies...",
      "flavor_tags": ["spicy", "savory", "nutty"],
      "search_term": "Kung Pao Chicken å®«ä¿é¸¡ä¸ food dish",
      "image_url": "https://..."
    }
  ],
  "metadata": {
    "processing_time_ms": 4500,
    "total_dishes": 3
  }
}
```

**å“åº”ï¼ˆé”™è¯¯ï¼‰**:
```json
{
  "success": false,
  "error": "Invalid image format or API quota exceeded",
  "error_code": "INVALID_IMAGE"
}
```

---

## 5. å…³é”®å®ç°ç»†èŠ‚

### 5.1 Gemini è°ƒç”¨é…ç½®

```python
from openai import OpenAI

client = OpenAI(
    api_key=os.getenv("GOOGLE_API_KEY"),
    base_url="https://generativelanguage.googleapis.com/v1beta/openai/"
)

# ä½¿ç”¨æ–¹å¼
response = client.chat.completions.create(
    model="gemini-1.5-pro",
    messages=[
        {
            "role": "user",
            "content": [
                {"type": "text", "text": "åˆ†æè¿™å¼ èœå•å›¾ç‰‡..."},
                {"type": "image_url", "image_url": {"url": f"data:image/jpeg;base64,{base64_image}"}}
            ]
        }
    ],
    temperature=0.2,
)
```

### 5.2 Gemini æç¤ºè¯æ¨¡æ¿

```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„èœå•è¯†åˆ«AIã€‚åˆ†æè¿™å¼ èœå•å›¾ç‰‡ï¼Œæå–æ‰€æœ‰å¯è§çš„èœå“ä¿¡æ¯ã€‚

è¿”å›ä¸¥æ ¼çš„ JSON æ ¼å¼ï¼ˆä¸è¦åŒ…å«markdownæ ‡è®°ï¼‰ï¼Œå¦‚ä¸‹ï¼š
{
  "dishes": [
    {
      "original_name": "èœå“åŸåï¼ˆä¸­æ–‡/æœ¬åœ°è¯­è¨€ï¼‰",
      "english_name": "è‹±æ–‡ç¿»è¯‘æˆ–é€šç”¨åç§°",
      "description": "è¯¦ç»†æè¿°ï¼ˆå£å‘³ã€ææ–™ç­‰ï¼‰",
      "flavor_tags": ["tag1", "tag2", "tag3"]
    }
  ]
}

è¦æ±‚ï¼š
- ä¸è¦ç¼–é€ èœå“ï¼Œåªè¯†åˆ«å›¾ç‰‡ä¸­å­˜åœ¨çš„
- description é™åˆ¶åœ¨150å­—ä»¥å†…
- flavor_tags æœ€å¤š5ä¸ªï¼Œä½¿ç”¨è‹±æ–‡
- å¦‚æœèœå“æ²¡æœ‰è‹±æ–‡åç§°ï¼Œä½¿ç”¨æ‹¼éŸ³+ç¿»è¯‘
```

### 5.3 å¹¶å‘æœç´¢å®ç°

```python
import asyncio
import aiohttp

async def search_image_for_dish(session, search_term):
    # è°ƒç”¨ Google Custom Search API
    # æå–ç¬¬ä¸€ä¸ªç»“æœçš„ image_url
    pass

async def search_all_dishes(dishes):
    async with aiohttp.ClientSession() as session:
        tasks = [search_image_for_dish(session, d.search_term) for d in dishes]
        results = await asyncio.gather(*tasks)
    return results
```

---

## 6. ç¯å¢ƒå˜é‡é…ç½®

åˆ›å»º `backend/.env`:

```env
# Gemini API
GOOGLE_API_KEY=AIza...your_key_here...

# Google Custom Search API
SEARCH_API_KEY=AIza...search_key_here...
SEARCH_ENGINE_ID=cx_...your_custom_search_id...

# FastAPI é…ç½®
BACKEND_PORT=8000
BACKEND_HOST=0.0.0.0
CORS_ORIGIN=http://localhost:5173

# æœç´¢é…ç½®
SEARCH_NUM_RESULTS=1
SEARCH_TIMEOUT=5
MAX_CONCURRENT_SEARCHES=10
```

---

## 7. é”™è¯¯å¤„ç† & è¾¹ç•Œæƒ…å†µ

| åœºæ™¯ | å¤„ç†æ–¹æ¡ˆ |
|------|---------|
| API é…é¢è¶…é™ | è¿”å› 429ï¼Œå‰ç«¯æ˜¾ç¤º"è¯·ç¨åé‡è¯•" |
| æ— æ•ˆå›¾ç‰‡æ ¼å¼ | è¿”å› 400ï¼Œå‰ç«¯æç¤ºæ”¯æŒçš„æ ¼å¼ |
| ç½‘ç»œè¶…æ—¶ | å›¾ç‰‡æœç´¢è¶…æ—¶åè¿”å› nullï¼ŒUI æ˜¾ç¤ºå ä½ç¬¦ |
| Gemini æ— æ³•è¯†åˆ«èœå“ | è¿”å›ç©º dishes åˆ—è¡¨ |
| CORS é”™è¯¯ | åç«¯é…ç½® CORS ä¸­é—´ä»¶ |

---

## 8. æ€§èƒ½æŒ‡æ ‡ï¼ˆç›®æ ‡ï¼‰

- èœå•è¯†åˆ«æ—¶é—´: < 3 ç§’ï¼ˆGemini APIï¼‰
- å›¾ç‰‡æœç´¢æ—¶é—´: < 2 ç§’ï¼ˆ10 é“èœï¼Œå¹¶å‘ï¼‰
- æ€»å¤„ç†æ—¶é—´: < 5 ç§’
- å‰ç«¯é¦–å±åŠ è½½: < 2 ç§’
- æœ€å¤§æ”¯æŒèœå“æ•°: 50 é“ï¼ˆå•å¼ å›¾ç‰‡ï¼‰

---

## 9. æ‰©å±•è€ƒè™‘

æœªæ¥ç‰ˆæœ¬å¯è€ƒè™‘ï¼š
- [ ] èœå“ä»·æ ¼æå–
- [ ] è¥å…»ä¿¡æ¯ OCR
- [ ] é¤å…ä½ç½®ä¿¡æ¯é›†æˆ
- [ ] ç”¨æˆ·æ”¶è—/åˆ†äº«åŠŸèƒ½
- [ ] å¤šè¯­è¨€æ”¯æŒ
- [ ] æœ¬åœ°æ¨¡å‹éƒ¨ç½²ï¼ˆå‡å°‘å»¶è¿Ÿï¼‰

---

## 10. éƒ¨ç½²æ¸…å•

- [ ] `.env.example` æ¨¡æ¿å‡†å¤‡
- [ ] å‰ç«¯ CORS é…ç½®éªŒè¯
- [ ] API è¯·æ±‚è¶…æ—¶è®¾ç½®
- [ ] é”™è¯¯æ—¥å¿—è®°å½•
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–å…³é”®è·¯å¾„
- [ ] Docker å®¹å™¨åŒ–ï¼ˆå¯é€‰ï¼‰

